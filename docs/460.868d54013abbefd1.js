"use strict";(self.webpackChunkylearnit_angular=self.webpackChunkylearnit_angular||[]).push([[460],{7460:(Mt,B,o)=>{o.r(B),o.d(B,{StudyModule:()=>C});var l=o(6895),k=o(529),a=o(433),p=o(7747),c=o(4166),t=o(1571),M=o(3743);class T{constructor(e,u){this.authService=e,this.router=u}canActivate(e,u){return!!this.authService.isAuth()||this.router.createUrlTree(["/login"])}canActivateChild(e,u){return!!this.authService.isAuth()||this.router.createUrlTree(["/login"])}}T.\u0275fac=function(e){return new(e||T)(t.LFG(M.e),t.LFG(c.F0))},T.\u0275prov=t.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"});var L=o(4004);class Q{constructor(e){this.id=e.id,this.accuracy=e.accuracy,this.retrievability=e.retrievability,this.thinkingTime=e.idleSeconds,this.totalTime=e.totalSeconds,this.date=new Date(e.date)}}class w{constructor(e){this.id=e.id,this.loop=e.loop,this.serialNumber=e.serialNumber,this.date=new Date(e.date),this.interval=e.interval,e.answer&&(this.answer=new Q(e.answer))}}class ${constructor(e){this.id=e.id,this.element=e.element,e.lastRep&&(this.lastRep=new w(e.lastRep)),this.nextRep=new w(e.nextRep)}}class j{constructor(e){this.id=e.id,this.element=e.element,e.lastRep&&(this.lastRep=new w(e.lastRep)),this.nextRep=new w(e.nextRep),this.repetitions=e.repetitions.map(u=>new w(u))}}var G=o(1133);class g{constructor(e,u){this.appConfig=e,this.http=u,this.studyUrl="/study"}getCourseById(e){return this.http.get(`${this.getApiUrl()}/course/${e}`)}getCoursesByTargetLang(e){return this.http.get(`${this.getApiUrl()}/courses`,{params:{targetLang:e,sourceLang:"ru"}})}addCourse(e){return this.http.post(`${this.getApiUrl()}/course/${e}`,{})}getLearningCourseById(e){return this.http.get(`${this.getApiUrl()}/lcourse/${e}`)}getLearningCoursesByTargetLang(e){return this.http.get(`${this.getApiUrl()}/lcourses/${e}`)}addTopicForLearningCourse(e,u){return this.http.post(`${this.getApiUrl()}/lcourse/${e}/${u}`,{})}getStudyTests(e,u,s="SM2"){let i=`${this.getApiUrl()}/tests`;return this.http.get(i,{params:{targetLang:e,sourceLang:u,testType:s}})}getStudyTestsByTopics(e,u,s,i="SM2"){let r=`${this.getApiUrl()}/tests`;return this.http.get(r,{params:{targetLang:e,sourceLang:u,ltIds:s,testType:i}})}endStudyTests(e){return this.http.post(`${this.getApiUrl()}/tests`,e)}getStatsByIds(e){return this.http.get(`${this.getApiUrl()}/stats`,{params:{leIds:e,sourceLang:"ru"}}).pipe((0,L.U)(u=>u.map(i=>{let r=i;return r.learningElement=new j(r.learningElement),r})))}getStatsByLearningTopic(e,u=0){return this.http.get(`${this.getApiUrl()}/stats/byLearningTopic/${e}`,{params:{page:u}}).pipe((0,L.U)(s=>s.map(r=>{let d=r;return d.learningElement=new $(d.learningElement),d})))}getApiUrl(){return this.appConfig.apiUrl+this.studyUrl}}g.\u0275fac=function(e){return new(e||g)(t.LFG(G._),t.LFG(k.eN))},g.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"});var N=o(8505);class h{constructor(e){this.studyService=e,this._tests=[],this._answers=[],this._curTest=0,this._lTopicIds=[],this._testType="SM2"}getStudyTests(){if(this._targetLang&&this._sourceLang)return 0==this._lTopicIds.length?this.studyService.getStudyTests(this._targetLang,this._sourceLang,this._testType).pipe((0,N.b)(e=>{this._tests=e,this._answers=[],this._curTest=0,console.debug(e)})):this.studyService.getStudyTestsByTopics(this._targetLang,this._sourceLang,this._lTopicIds,this._testType).pipe((0,N.b)(e=>{this._tests=e,this._answers=[],this._curTest=0,console.debug(e)}));throw new Error("Target lang or source lang not setted")}endStudyTests(){return this.studyService.endStudyTests(this._answers)}onReviewByCourse(e){let u=[];for(let s of e.topics)s.added&&u.push(s.lTopicId);this.learningTopicIds=u,this.targetLang=e.targetLang,this.sourceLang=e.sourceLang}onReviewByTopic(e,u){this.learningTopicIds=[u.lTopicId],this.targetLang=e.targetLang,this.sourceLang=e.sourceLang}getTestCount(){return this._tests.length}getTest(e){return this._tests[e]}get tests(){return this._tests}getNextTest(){return this._curTest+1<this._tests.length&&(this._curTest+=1),this._tests[this._curTest]}addAnswer(e){this._answers.push(e)}get answers(){return this._answers}get learningTopicIds(){return this._lTopicIds}set learningTopicIds(e){this._lTopicIds=e}get targetLang(){return this._targetLang}set targetLang(e){this._targetLang=e}get sourceLang(){return this._sourceLang}set sourceLang(e){this._sourceLang=e}get type(){return this._testType}set type(e){this._testType=e}clear(){this._tests=[],this._answers=[],this._lTopicIds=[],this._curTest=0,this._testType="SM2"}}function H(n,e){1&n&&(t.TgZ(0,"button",8),t._uU(1,"\u0418\u0437\u0443\u0447\u0430\u0435\u0442\u0441\u044f"),t.qZA())}function K(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(u);const i=t.oxw(2);return t.KtG(i.addCourse())}),t._uU(1,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),t.qZA()}if(2&n){const u=t.oxw(2);t.Q6J("disabled",u.isDisabledButtons)}}function W(n,e){1&n&&(t.TgZ(0,"span",13),t._uU(1,"\u0438\u0437\u0443\u0447\u0430\u0435\u0442\u0441\u044f"),t.qZA())}function X(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"button",14),t._uU(2," \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 "),t.qZA(),t.TgZ(3,"button",15),t.NdJ("click",function(){t.CHM(u);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.onReviewByTopic(r.course,i))}),t._uU(4," \u041f\u0440\u043e\u0439\u0442\u0438 \u0442\u0435\u0441\u0442 "),t.qZA()()}if(2&n){const u=t.oxw().$implicit;t.xp6(1),t.MGl("routerLink","/app/stats/ltopic/",u.lTopicId,"")}}function P(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"button",16),t.NdJ("click",function(){t.CHM(u);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.addTopic(i))}),t._uU(2,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),t.qZA()()}if(2&n){const u=t.oxw(3);t.xp6(1),t.Q6J("disabled",u.isDisabledButtons)}}function z(n,e){if(1&n&&(t.TgZ(0,"div",1)(1,"div",10)(2,"div",11)(3,"h5"),t._uU(4),t.YNc(5,W,2,0,"span",12),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA(),t.YNc(10,X,5,1,"div",0),t.YNc(11,P,3,1,"div",0),t.qZA()()()),2&n){const u=e.$implicit,s=t.oxw(2);t.xp6(4),t.hij("\u0422\u0435\u043c\u0430: ",u.title," "),t.xp6(1),t.Q6J("ngIf",u.added),t.xp6(2),t.hij("\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: ",u.difficult,""),t.xp6(2),t.Oqu(u.description),t.xp6(1),t.Q6J("ngIf",u.added),t.xp6(1),t.Q6J("ngIf",s.course.added&&!u.added)}}function V(n,e){if(1&n&&(t.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t._uU(5),t.qZA()(),t.YNc(6,H,2,0,"button",4),t.YNc(7,K,2,1,"button",5),t.qZA(),t.TgZ(8,"div")(9,"p"),t._uU(10,"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u044f\u0437\u044b\u043a: "),t.TgZ(11,"span",6),t._uU(12),t.qZA()(),t.TgZ(13,"p"),t._uU(14,"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u044f\u0437\u044b\u043a: "),t.TgZ(15,"span",6),t._uU(16),t.qZA()(),t.TgZ(17,"p"),t._uU(18),t.qZA(),t.TgZ(19,"p"),t._uU(20),t.qZA()()(),t.YNc(21,z,12,6,"div",7),t.qZA()),2&n){const u=t.oxw();t.xp6(5),t.Oqu(u.course.title),t.xp6(1),t.Q6J("ngIf",u.course.added),t.xp6(1),t.Q6J("ngIf",!u.course.added),t.xp6(5),t.Oqu(u.course.targetLang),t.xp6(4),t.Oqu(u.course.sourceLang),t.xp6(2),t.hij("\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: ",u.course.difficult,""),t.xp6(2),t.Oqu(u.course.description),t.xp6(1),t.Q6J("ngForOf",u.course.topics)}}h.\u0275fac=function(e){return new(e||h)(t.LFG(g))},h.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"});class y{constructor(e,u,s,i){this.studyService=e,this.reviewService=u,this.route=s,this.router=i,this.isDisabledButtons=!1}ngOnInit(){this.getCourse(this.route.snapshot.params.id)}getCourse(e){this.studyService.getCourseById(e).subscribe({next:u=>{this.course=u,console.log(u)},error:u=>{console.error(u)}})}addCourse(){this.course&&(this.isDisabledButtons=!0,this.studyService.addCourse(this.course.id).subscribe({next:e=>{this.ngOnInit(),this.isDisabledButtons=!1},error:e=>{console.log(e)}}))}addTopic(e){this.course&&e&&(this.isDisabledButtons=!0,this.studyService.addTopicForLearningCourse(this.course.lCourseId,e.id).subscribe({next:u=>{this.ngOnInit(),this.isDisabledButtons=!1},error:u=>{console.log(u)}}))}onReviewByCourse(e){e.added&&(this.reviewService.onReviewByCourse(e),console.debug("by course="+e.lCourseId),this.router.navigate(["/app/test"]))}onReviewByTopic(e,u){e.added&&u.added&&(this.reviewService.onReviewByTopic(e,u),console.debug("by topic="+u.lTopicId),this.router.navigate(["/app/test"]))}}y.\u0275fac=function(e){return new(e||y)(t.Y36(g),t.Y36(h),t.Y36(c.gz),t.Y36(c.F0))},y.\u0275cmp=t.Xpm({type:y,selectors:[["study-course-details"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"m-2"],[1,"row"],[1,"col-auto"],["class","col-3 btn btn-info disabled",4,"ngIf"],["class","col-3 btn btn-info",3,"disabled","click",4,"ngIf"],[1,"badge","bg-secondary"],["class","m-2",4,"ngFor","ngForOf"],[1,"col-3","btn","btn-info","disabled"],[1,"col-3","btn","btn-info",3,"disabled","click"],[1,"card"],[1,"card-body"],["class","badge bg-info",4,"ngIf"],[1,"badge","bg-info"],[1,"btn","btn-primary",3,"routerLink"],[1,"btn","btn-primary","mx-2",3,"click"],[1,"btn","btn-info",3,"disabled","click"]],template:function(e,u){1&e&&t.YNc(0,V,22,8,"div",0),2&e&&t.Q6J("ngIf",u.course)},dependencies:[l.sg,l.O5,c.rH]});var J=o(7579),tt=o(1566),et=o(4482),ut=o(5403),st=o(1884),it=o(9300),rt=o(6451);const ot=["instance"];function at(n,e){if(1&n&&(t.TgZ(0,"a",12),t._uU(1,"learning"),t.qZA()),2&n){const u=t.oxw().$implicit;t.MGl("routerLink","../course/",u.id,"")}}function lt(n,e){if(1&n&&(t.TgZ(0,"div",7)(1,"div",8)(2,"a",9),t._uU(3),t.qZA(),t.YNc(4,at,2,1,"a",10),t.qZA(),t.TgZ(5,"div",11)(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA()()()),2&n){const u=e.$implicit;t.xp6(2),t.MGl("routerLink","../course/",u.id,""),t.xp6(1),t.Oqu(u.title),t.xp6(1),t.Q6J("ngIf",u.added),t.xp6(3),t.hij("\u0412\u0441\u0435\u0433\u043e \u0442\u0435\u043c: ",u.topics.length,""),t.xp6(2),t.hij("\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: ",u.difficult,"")}}const R=[{code:"en",name:"\u0410\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439"}];class b{constructor(e){this.studyService=e,this.formatter=u=>u.name,this.focus$=new J.x,this.click$=new J.x,this.search=u=>{const s=u.pipe(function nt(n,e=tt.z){return(0,et.e)((u,s)=>{let i=null,r=null,d=null;const Z=()=>{if(i){i.unsubscribe(),i=null;const _=r;r=null,s.next(_)}};function D(){const _=d+n,I=e.now();if(I<_)return i=this.schedule(void 0,_-I),void s.add(i);Z()}u.subscribe((0,ut.x)(s,_=>{r=_,d=e.now(),i||(i=e.schedule(D,n),s.add(i))},()=>{Z(),s.complete()},void 0,()=>{r=i=null}))})}(200),(0,st.x)()),i=this.click$.pipe((0,it.h)(()=>!this.instance.isPopupOpen()));return(0,rt.T)(s,this.focus$,i).pipe((0,L.U)(d=>""===d?R:R.filter(Z=>new RegExp(d,"mi").test(Z.name)).slice(0,10)))}}ngOnInit(){}getCourses(){this.langField&&this.studyService.getCoursesByTargetLang(this.langField.code).subscribe({next:e=>{this.courses=e,console.debug(e)},error:e=>{console.error(e)}})}}function ct(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"a",5),t._uU(3),t.qZA()(),t.TgZ(4,"div",6)(5,"button",7),t.NdJ("click",function(){const r=t.CHM(u).$implicit,d=t.oxw(2);return t.KtG(d.onReviewByCourse(r))}),t._uU(6,"\u041f\u0440\u043e\u0439\u0442\u0438 \u0442\u0435\u0441\u0442"),t.qZA()()()}if(2&n){const u=e.$implicit,s=e.index;t.xp6(2),t.MGl("routerLink","./course/",u.id,""),t.xp6(1),t.AsE(" ",s+1,") ",u.title," ")}}function dt(n,e){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,ct,7,3,"div",2),t.qZA()),2&n){const u=t.oxw();t.xp6(1),t.Q6J("ngForOf",u.learningCourses)}}function pt(n,e){1&n&&(t.TgZ(0,"div")(1,"p"),t._uU(2,"\u041a\u0443\u0440\u0441\u044b \u043d\u0435 "),t.TgZ(3,"a",8),t._uU(4,"\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b"),t.qZA()()())}b.\u0275fac=function(e){return new(e||b)(t.Y36(g))},b.\u0275cmp=t.Xpm({type:b,selectors:[["study-courses-list"]],viewQuery:function(e,u){if(1&e&&t.Gf(ot,7),2&e){let s;t.iGM(s=t.CRH())&&(u.instance=s.first)}},decls:16,vars:7,consts:[[1,"mt-3"],[1,"row"],[1,"col-auto"],["type","text",1,"form-control",3,"ngModel","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","focus","click"],["instance","ngbTypeahead"],[1,"btn","btn-info",3,"disabled","click"],["class","card my-3",4,"ngFor","ngForOf"],[1,"card","my-3"],[1,"card-header"],[1,"card-title","link-info","h5",3,"routerLink"],["class","btn badge bg-info ms-3",3,"routerLink",4,"ngIf"],[1,"card-body","justify-content-between"],[1,"btn","badge","bg-info","ms-3",3,"routerLink"]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u041a\u0443\u0440\u0441\u044b"),t.qZA(),t._UZ(3,"hr"),t.TgZ(4,"div",1)(5,"div",2)(6,"label"),t._uU(7,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u044f\u0437\u044b\u043a:"),t.qZA()(),t.TgZ(8,"div",2)(9,"input",3,4),t.NdJ("ngModelChange",function(i){return u.langField=i})("focus",function(i){return u.focus$.next(i.target.value)})("click",function(i){return u.click$.next(i.target.value)}),t.qZA()(),t.TgZ(11,"div",2)(12,"button",5),t.NdJ("click",function(){return u.getCourses()}),t._uU(13,"\u041d\u0430\u0439\u0442\u0438"),t.qZA()()(),t._UZ(14,"hr"),t.YNc(15,lt,10,5,"div",6),t.qZA()),2&e&&(t.xp6(9),t.Q6J("ngModel",u.langField)("ngbTypeahead",u.search)("editable",!1)("inputFormatter",u.formatter)("resultFormatter",u.formatter),t.xp6(3),t.Q6J("disabled",!(null!=u.langField&&u.langField.code)),t.xp6(3),t.Q6J("ngForOf",u.courses))},dependencies:[l.sg,l.O5,c.rH,p.dR,a.Fj,a.JJ,a.On]});class A{constructor(e,u,s){this.studyService=e,this.reviewService=u,this.router=s}ngOnInit(){this.studyService.getLearningCoursesByTargetLang("en").subscribe({next:e=>{this.learningCourses=e,console.debug(e)},error:e=>{console.error(e)}})}onReviewByCourse(e){e.added&&(this.reviewService.onReviewByCourse(e),console.debug("by course="+e.id),this.router.navigate(["/app/test"]))}}A.\u0275fac=function(e){return new(e||A)(t.Y36(g),t.Y36(h),t.Y36(c.F0))},A.\u0275cmp=t.Xpm({type:A,selectors:[["study-dashboard"]],decls:5,vars:2,consts:[[1,"mt-3"],[4,"ngIf"],["class","card my-3",4,"ngFor","ngForOf"],[1,"card","my-3"],[1,"card-header"],[1,"link","link-info","h5",3,"routerLink"],[1,"card-body"],[1,"btn","btn-primary",3,"click"],["routerLink","./courses"]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043a\u0443\u0440\u0441\u044b"),t.qZA(),t.YNc(3,dt,2,1,"div",1),t.YNc(4,pt,5,0,"div",1),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf",u.learningCourses),t.xp6(1),t.Q6J("ngIf",0==(null==u.learningCourses?null:u.learningCourses.length)))},dependencies:[l.sg,l.O5,c.rH]});class x{constructor(e,u){this.authService=e,this.router=u,this.isMenuCollapsed=!0,this.username=localStorage.getItem("userName"),this.brand="YLearnIt",this.easter()}onLogOut(){console.log("Log out"),this.authService.logout(),this.router.navigate(["/login"])}easter(){Math.random()<.1&&(this.brand="\u3088\u3057! LearnIt!")}}function gt(n,e){if(1&n&&(t.TgZ(0,"tr")(1,"th",6),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA()()),2&n){const u=e.$implicit,s=e.index;t.xp6(2),t.Oqu(s+1),t.xp6(2),t.hij(" ",u.contentId," "),t.xp6(2),t.hij(" ",u.content," "),t.xp6(2),t.hij(" ",u.lang," "),t.xp6(2),t.hij(" ",u.sideType," ")}}function ht(n,e){if(1&n&&(t.TgZ(0,"tr")(1,"th",6),t._uU(2),t.qZA(),t.TgZ(3,"th",6),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",7),t._uU(8),t.qZA(),t.TgZ(9,"td",7),t._uU(10),t.qZA(),t.TgZ(11,"td",7),t._uU(12),t.qZA(),t.TgZ(13,"td",7),t._uU(14),t.qZA(),t.TgZ(15,"td",7),t._uU(16),t.qZA()()),2&n){const u=e.$implicit;t.xp6(2),t.hij(" ",u.loop," "),t.xp6(2),t.hij(" ",u.serialNumber," "),t.xp6(2),t.hij(" ",u.interval," "),t.xp6(2),t.hij(" ",u.date.toLocaleDateString()," "),t.xp6(2),t.hij(" ",null==u.answer||null==u.answer.date?null:u.answer.date.toLocaleString()," "),t.xp6(2),t.hij(" ",null==u.answer?null:u.answer.accuracy," "),t.xp6(2),t.hij(" ",null==u.answer?null:u.answer.retrievability," "),t.xp6(2),t.hij(" ",null==u.answer?null:u.answer.thinkingTime," ")}}function _t(n,e){if(1&n&&(t.TgZ(0,"div")(1,"h4"),t._uU(2,"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430"),t.qZA(),t.TgZ(3,"div",2)(4,"table",3)(5,"thead")(6,"tr")(7,"th",4),t._uU(8,"#"),t.qZA(),t.TgZ(9,"th",4),t._uU(10,"CID"),t.qZA(),t.TgZ(11,"th",4),t._uU(12,"\u0421\u043b\u043e\u0432\u043e"),t.qZA(),t.TgZ(13,"th",4),t._uU(14,"\u042f\u0437\u044b\u043a"),t.qZA(),t.TgZ(15,"th",4),t._uU(16,"\u0422\u0438\u043f \u0441\u0442\u043e\u0440\u043e\u043d\u044b"),t.qZA()()(),t.TgZ(17,"tbody"),t.YNc(18,gt,11,5,"tr",5),t.qZA()()(),t._UZ(19,"hr"),t.TgZ(20,"h4"),t._uU(21,"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f"),t.qZA(),t.TgZ(22,"div",2)(23,"table",3)(24,"thead")(25,"tr")(26,"th",4),t._uU(27,"\u041a\u0440\u0443\u0433"),t.qZA(),t.TgZ(28,"th",4),t._uU(29,"\u041d\u043e\u043c\u0435\u0440"),t.qZA(),t.TgZ(30,"th",4),t._uU(31,"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b"),t.qZA(),t.TgZ(32,"th",4),t._uU(33,"\u0414\u0430\u0442\u0430 \u043f\u043e\u0432\u0442\u043e\u0440\u0430"),t.qZA(),t.TgZ(34,"th",4),t._uU(35,"\u0414\u0430\u0442\u0430 \u043e\u0442\u0432\u0435\u0442\u0430"),t.qZA(),t.TgZ(36,"th",4),t._uU(37,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c"),t.qZA(),t.TgZ(38,"th",4),t._uU(39,"\u041f\u0430\u043c\u044f\u0442\u044c"),t.qZA(),t.TgZ(40,"th",4),t._uU(41,"\u0412\u0440\u0435\u043c\u044f (\u0441\u0435\u043a.)"),t.qZA()()(),t.TgZ(42,"tbody"),t.YNc(43,ht,17,8,"tr",5),t.qZA()()()()),2&n){const u=t.oxw();t.xp6(18),t.Q6J("ngForOf",u.learningCard.card.sides),t.xp6(25),t.Q6J("ngForOf",u.learningCard.learningElement.repetitions)}}x.\u0275fac=function(e){return new(e||x)(t.Y36(M.e),t.Y36(c.F0))},x.\u0275cmp=t.Xpm({type:x,selectors:[["study-home"]],decls:26,vars:3,consts:[[1,"d-flex","flex-column","bg-light","min-vh-100"],[1,"navbar","shadow","sticky-top","navbar-expand-md","navbar-dark","bg-dark"],[1,"container"],["routerLink","/app",1,"navbar-brand"],["type","button",1,"navbar-toggler",3,"click"],[1,"collapse","navbar-collapse","justify-content-between",3,"ngbCollapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","./courses",1,"nav-link",3,"click"],["routerLink","./test",1,"nav-link",3,"click"],["ngbDropdown","",1,"nav-item","mr-auto"],["type","button","ngbDropdownToggle","",1,"nav-link"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end","dropdown-menu-dark"],["ngbDropdownItem","",3,"click"],[1,"row","min-vh-100","justify-content-center"],[1,"col-lg-8","bg-white"]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"div",2)(3,"a",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return u.isMenuCollapsed=!u.isMenuCollapsed}),t._uU(6," \u2630 "),t.qZA(),t.TgZ(7,"div",5)(8,"ul",6)(9,"li",7)(10,"a",8),t.NdJ("click",function(){return u.isMenuCollapsed=!0}),t._uU(11,"\u041a\u0443\u0440\u0441\u044b"),t.qZA()(),t.TgZ(12,"li",7)(13,"a",9),t.NdJ("click",function(){return u.isMenuCollapsed=!0}),t._uU(14,"\u0422\u0435\u0441\u0442\u044b"),t.qZA()()(),t.TgZ(15,"ul",6)(16,"li",10)(17,"a",11),t._uU(18),t.qZA(),t.TgZ(19,"div",12)(20,"button",13),t.NdJ("click",function(){return u.onLogOut()}),t._uU(21,"\u0412\u044b\u0439\u0442\u0438"),t.qZA()()()()()()(),t.TgZ(22,"div",2)(23,"div",14)(24,"div",15),t._UZ(25,"router-outlet"),t.qZA()()()()),2&e&&(t.xp6(4),t.Oqu(u.brand),t.xp6(3),t.Q6J("ngbCollapse",u.isMenuCollapsed),t.xp6(11),t.Oqu(u.username))},dependencies:[c.lC,c.rH,p._D,p.jt,p.iD,p.Vi,p.TH,p.M2]});class S{constructor(e,u,s){this.studyService=e,this.route=u,this.router=s}ngOnInit(){this.leId=this.route.snapshot.params.lElementId,this.leId&&this.studyService.getStatsByIds([this.leId]).subscribe({next:e=>{e.length>0&&(this.learningCard=e[0],console.debug(e))},error:e=>{console.error(e)}})}}function Tt(n,e){if(1&n&&(t.TgZ(0,"tr")(1,"th",6),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"a",7),t._uU(5),t.qZA()(),t.TgZ(6,"td",8),t._uU(7),t.qZA(),t.TgZ(8,"td",8),t._uU(9),t.qZA(),t.TgZ(10,"td",8),t._uU(11),t.qZA(),t.TgZ(12,"td",8),t._uU(13),t.qZA()()),2&n){const u=e.$implicit,s=e.index,i=t.oxw();t.xp6(2),t.Oqu(s+1),t.xp6(2),t.MGl("routerLink","../../lelement/",u.learningElement.id,""),t.xp6(1),t.hij(" ",i.getContent(u.card,u.learningElement.element.targetLang)," "),t.xp6(2),t.hij(" ",null==u.learningElement.lastRep||null==u.learningElement.lastRep.answer?null:u.learningElement.lastRep.answer.accuracy," "),t.xp6(2),t.hij(" ",null==u.learningElement.lastRep||null==u.learningElement.lastRep.answer?null:u.learningElement.lastRep.answer.retrievability," "),t.xp6(2),t.hij(" ",null==u.learningElement.lastRep||null==u.learningElement.lastRep.answer||null==u.learningElement.lastRep.answer.date?null:u.learningElement.lastRep.answer.date.toLocaleString()," "),t.xp6(2),t.hij(" ",i.getLocaleDateString(u.learningElement.nextRep.date)," ")}}function mt(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div",9)(1,"button",10),t.NdJ("click",function(){t.CHM(u);const i=t.oxw();return t.KtG(i.getNextPage())}),t._uU(2,"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435"),t.qZA()()}}S.\u0275fac=function(e){return new(e||S)(t.Y36(g),t.Y36(c.gz),t.Y36(c.F0))},S.\u0275cmp=t.Xpm({type:S,selectors:[["study-learning-card-details"]],decls:5,vars:1,consts:[[1,"mt-3"],[4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"text-nowrap"]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0438\u0437\u0443\u0447\u0430\u0435\u043c\u043e\u043c\u0443 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0443"),t.qZA(),t._UZ(3,"hr"),t.YNc(4,_t,44,2,"div",1),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",u.learningCard))},dependencies:[l.sg,l.O5]});class E{constructor(e,u,s){this.studyService=e,this.route=u,this.router=s,this.learningCards=[],this.page=0,this.hasPages=!0}ngOnInit(){this.lTopicId=this.route.snapshot.params.lTopicId,this.lTopicId&&this.getByPage(this.lTopicId,this.page)}getContent(e,u){for(let s of e.sides)if(s.lang===u)return s.content}getByPage(e,u){this.studyService.getStatsByLearningTopic(e,u).subscribe({next:s=>{s.length>0?(this.learningCards=this.learningCards.concat(s),this.page+=1,console.debug(s)):this.hasPages=!1},error:s=>{console.error(s)}})}getNextPage(){this.lTopicId&&this.page&&this.getByPage(this.lTopicId,this.page)}getLocaleDateString(e){let u=new Date(e),s=new Date,i=u.getTime()-s.getTime(),r=Math.ceil(i/864e5);return 0==r?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":1==r?"\u0417\u0430\u0432\u0442\u0440\u0430":r<=31&&r>0?`\u0427\u0435\u0440\u0435\u0437 ${r} \u0434\u043d\u0435\u0439`:u.toLocaleDateString()}}E.\u0275fac=function(e){return new(e||E)(t.Y36(g),t.Y36(c.gz),t.Y36(c.F0))},E.\u0275cmp=t.Xpm({type:E,selectors:[["study-learning-card-list"]],decls:22,vars:2,consts:[[1,"mt-3"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],["class","text-center my-3",4,"ngIf"],["scope","row"],[1,"link","link-primary",3,"routerLink"],[1,"text-nowrap"],[1,"text-center","my-3"],[1,"btn","btn-primary",3,"click"]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0442\u0435\u043c\u0435"),t.qZA(),t.TgZ(3,"div",1)(4,"table",2)(5,"thead")(6,"tr")(7,"th",3),t._uU(8,"#"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"\u0421\u043b\u043e\u0432\u043e"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"\u041f\u0430\u043c\u044f\u0442\u044c"),t.qZA(),t.TgZ(15,"th",3),t._uU(16,"\u041f\u043e\u0441\u043b. \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0435"),t.qZA(),t.TgZ(17,"th",3),t._uU(18,"\u0421\u043b\u0435\u0434. \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0435"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,Tt,14,7,"tr",4),t.qZA()()(),t.YNc(21,mt,3,0,"div",5),t.qZA()),2&e&&(t.xp6(20),t.Q6J("ngForOf",u.learningCards),t.xp6(1),t.Q6J("ngIf",u.hasPages))},dependencies:[l.sg,l.O5,c.rH]});class O{constructor(e,u,s,i,r,d,Z,D,_,I){this.testAnswers=e,this.userAnswer=u,this.type=s,this.thinkingTime=i,this.totalTime=r,this.dbName=d,this.elementIdDb=Z,this.learningElementId=D,this.repetitionId=_,this.data=I}}class Y{constructor(e,u,s,i,r,d){this.contentId=e,this.content=u,this.contentType=s,this.lang=i,this.sideType=r,this.variants=d}}function ft(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"p"),t._uU(2,"\u041e\u0442\u0432\u0435\u0442?"),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){t.CHM(u);const i=t.oxw();return t.KtG(i.showAnswer())}),t._uU(5,"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0442\u0432\u0435\u0442"),t.qZA()()()}}function vt(n,e){if(1&n&&(t.TgZ(0,"h4",1),t._uU(1),t.qZA()),2&n){const u=e.$implicit;t.xp6(1),t.Oqu(u.content)}}function Ct(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){const r=t.CHM(u).$implicit,d=t.oxw(2);return t.KtG(d.onMark(r))}),t._uU(1),t.qZA()}if(2&n){const u=e.$implicit;t.xp6(1),t.hij(" ",u," ")}}function Zt(n,e){if(1&n&&(t.TgZ(0,"div")(1,"p"),t._uU(2,"\u041e\u0442\u0432\u0435\u0442:"),t.qZA(),t.YNc(3,vt,2,1,"h4",3),t._UZ(4,"hr"),t.TgZ(5,"div")(6,"label"),t._uU(7,"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u043e\u0442\u0432\u0435\u0442:"),t.qZA(),t.TgZ(8,"div",4)(9,"button",5),t._uU(10,"?"),t.qZA(),t.TgZ(11,"div",6)(12,"label",7),t._uU(13,"5 \u2013 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442"),t.qZA(),t.TgZ(14,"label",7),t._uU(15,"4 \u2013 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u043f\u043e\u0441\u043b\u0435 \u043a\u043e\u043b\u0435\u0431\u0430\u043d\u0438\u044f"),t.qZA(),t.TgZ(16,"label",7),t._uU(17,"3 \u2013 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u0432\u0441\u043f\u043e\u043c\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0432 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u0442\u0440\u0443\u0434\u043e\u043c"),t.qZA(),t.TgZ(18,"label",7),t._uU(19,"2 \u2013 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442, \u0433\u0434\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043a\u0430\u0437\u0430\u043b\u043e\u0441\u044c \u043b\u0435\u0433\u043a\u043e \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u0442\u044c"),t.qZA(),t.TgZ(20,"label",7),t._uU(21,"1 \u2013 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442, \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u043b"),t.qZA(),t.TgZ(22,"label",7),t._uU(23,"0 \u2013 \u043d\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430, \u043d\u0435 \u0437\u0430\u043f\u043e\u043c\u043d\u0438\u043b\u0441\u044f"),t.qZA()()()(),t.TgZ(24,"div",8),t.YNc(25,Ct,2,1,"button",9),t.qZA()()),2&n){const u=t.oxw();t.xp6(3),t.Q6J("ngForOf",u.studyTest.answers),t.xp6(22),t.Q6J("ngForOf",u.sm2Marks)}}class m{constructor(){this.userAnswerEvent=new t.vpe,this.isShowAnswer=!1,this.sm2Marks=["0","1","2","3","4","5"]}ngOnInit(){this.start=new Date,this.isShowAnswer=!1,this.curMark=void 0,console.debug("Start="+this.start)}showAnswer(){this.isShowAnswer=!0,this.end=new Date,console.debug("End="+this.end),console.debug("Total=",this.end.getTime()-this.start.getTime())}onMark(e){this.curMark=e,this.onNext()}onNext(){if(this.curMark){let e=Math.round((this.end.getTime()-this.start.getTime())/1e3),s=this.buildUserAnswer(this.curMark,e,e);this.userAnswerEvent.emit(s)}}buildUserAnswer(e,u,s){let i=new Y(-1,e,"TEXT_PLAIN","en","USER_ANSWER",[]);return new O(this.studyTest.answers,i,"SM2",u,s,this.studyTest.dbName,this.studyTest.elementIdDb,this.studyTest.learningElementId,this.studyTest.repetitionId,"")}}m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=t.Xpm({type:m,selectors:[["study-sm2-test"]],inputs:{studyTest:"studyTest"},outputs:{userAnswerEvent:"userAnswerEvent"},decls:3,vars:2,consts:[[4,"ngIf"],[1,"text-center"],[1,"btn","btn-info",3,"click"],["class","text-center",4,"ngFor","ngForOf"],["ngbDropdown","",1,"my-4"],["ngbDropdownToggle","",1,"btn","btn-info"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",1,"text-wrap"],[1,"row"],["class","btn btn-outline-primary mx-2 col",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary","mx-2","col",3,"click"]],template:function(e,u){1&e&&(t.TgZ(0,"div"),t.YNc(1,ft,6,0,"div",0),t.YNc(2,Zt,26,2,"div",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!u.isShowAnswer),t.xp6(1),t.Q6J("ngIf",u.isShowAnswer))},dependencies:[l.sg,l.O5,p.jt,p.iD,p.Vi,p.TH]});class f{constructor(e){this.viewContainerRef=e}}function wt(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"p"),t._uU(2,"\u041e\u0442\u0432\u0435\u0442?"),t.qZA(),t.TgZ(3,"form",1),t.NdJ("ngSubmit",function(){t.CHM(u);const i=t.oxw();return t.KtG(i.onAnswerSubmit())}),t.TgZ(4,"div",2)(5,"div",3)(6,"input",4),t.NdJ("ngModelChange",function(i){t.CHM(u);const r=t.oxw();return t.KtG(r.onAnswerChange(i))}),t.qZA()(),t.TgZ(7,"div",5)(8,"button",6),t._uU(9,"\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c"),t.qZA()()()()()}if(2&n){const u=t.oxw();t.xp6(3),t.Q6J("formGroup",u.answer)}}function yt(n,e){if(1&n&&(t.TgZ(0,"h4",7),t._uU(1),t.qZA()),2&n){const u=e.$implicit;t.xp6(1),t.Oqu(u.content)}}function bt(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"p"),t._uU(2,"\u0412\u0430\u0448 \u043e\u0442\u0432\u0435\u0442:"),t.qZA(),t.TgZ(3,"h4",7),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6,"\u041e\u0442\u0432\u0435\u0442:"),t.qZA(),t.YNc(7,yt,2,1,"h4",8),t.TgZ(8,"button",9),t.NdJ("click",function(){t.CHM(u);const i=t.oxw();return t.KtG(i.onNext())}),t._uU(9,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043e\u0442\u0432\u0435\u0442"),t.qZA()()}if(2&n){const u=t.oxw();t.xp6(4),t.Oqu(u.answer.controls.answer.value),t.xp6(3),t.Q6J("ngForOf",u.studyTest.answers)}}f.\u0275fac=function(e){return new(e||f)(t.Y36(t.s_b))},f.\u0275dir=t.lG2({type:f,selectors:[["","studyAnswerTest",""]]});class U{constructor(e){this.fb=e,this.WRITE_DELTA_MS=1e3,this.userAnswerEvent=new t.vpe,this.isShowAnswer=!1,this.changeTimestamps=[],this.answer=this.fb.group({answer:new a.NI("")})}ngOnInit(){this.isShowAnswer=!1,this.changeTimestamps.push(new Date)}onAnswerChange(e){this.changeTimestamps.push(new Date)}onAnswerSubmit(){this.changeTimestamps.push(new Date),this.isShowAnswer=!0}onNext(){let e=this.calcDeltaList(this.changeTimestamps),u=this.calcTotalTime(e),s=this.calcThinkingTime(e),i=this.buildUserAnswer(this.answer.controls.answer.value,s,u);this.userAnswerEvent.emit(i)}buildUserAnswer(e,u,s){let i=new Y(-1,e,"TEXT_PLAIN","en","USER_ANSWER",[]);return new O(this.studyTest.answers,i,"WRITE",u,s,this.studyTest.dbName,this.studyTest.elementIdDb,this.studyTest.learningElementId,this.studyTest.repetitionId,"")}calcDeltaList(e){let u=[];for(let s=0;s<e.length-1;s++){let i=e[s].getTime(),r=e[s+1].getTime();u.push(r-i)}return u}calcThinkingTime(e){let u=0;for(let s of e)s>this.WRITE_DELTA_MS&&(u+=s);return Math.round(u/1e3)}calcTotalTime(e){let u=0;for(let s of e)u+=s;return Math.round(u/1e3)}}function At(n,e){}U.\u0275fac=function(e){return new(e||U)(t.Y36(a.qu))},U.\u0275cmp=t.Xpm({type:U,selectors:[["study-write-test"]],inputs:{studyTest:"studyTest"},outputs:{userAnswerEvent:"userAnswerEvent"},decls:3,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],["type","text","formControlName","answer",1,"form-control",3,"ngModelChange"],[1,"col-4"],["type","submit",1,"btn","btn-primary"],[1,"text-center"],["class","text-center",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"]],template:function(e,u){1&e&&(t.TgZ(0,"div"),t.YNc(1,wt,10,1,"div",0),t.YNc(2,bt,10,2,"div",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!u.isShowAnswer),t.xp6(1),t.Q6J("ngIf",u.isShowAnswer))},dependencies:[l.sg,l.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]});class q{constructor(){this.userAnswerEvent=new t.vpe}ngOnInit(){console.debug("study-test-component init"),this.loadTest()}loadTest(){let e;switch(this.studyTest.type){case"SM2":console.debug("sm2"),e=m;break;case"WRITE":console.debug("write"),e=U;break;default:console.debug("default - sm2"),e=m}let u=this.test.viewContainerRef;u.clear();let s=u.createComponent(e);s.instance.studyTest=this.studyTest,s.instance.userAnswerEvent.subscribe(i=>this.addAnswer(i))}addAnswer(e){console.debug("answer event"),this.userAnswerEvent.emit(e)}}function xt(n,e){if(1&n&&(t.TgZ(0,"option",11),t._uU(1),t.qZA()),2&n){const u=e.$implicit;t.Q6J("ngValue",u),t.xp6(1),t.Oqu(u)}}function St(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"label"),t._uU(4,"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u044f\u0437\u044b\u043a"),t.qZA(),t.TgZ(5,"input",6),t.NdJ("ngModelChange",function(i){t.CHM(u);const r=t.oxw();return t.KtG(r.reviewService.targetLang=i)}),t.qZA()(),t.TgZ(6,"div",5)(7,"label"),t._uU(8,"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u044f\u0437\u044b\u043a"),t.qZA(),t.TgZ(9,"input",6),t.NdJ("ngModelChange",function(i){t.CHM(u);const r=t.oxw();return t.KtG(r.reviewService.sourceLang=i)}),t.qZA()()(),t.TgZ(10,"div",7)(11,"div",5)(12,"label"),t._uU(13,"\u0422\u0438\u043f \u0442\u0435\u0441\u0442\u0430"),t.qZA(),t.TgZ(14,"select",8),t.NdJ("ngModelChange",function(i){t.CHM(u);const r=t.oxw();return t.KtG(r.reviewService.type=i)}),t.YNc(15,xt,2,2,"option",9),t.qZA()(),t.TgZ(16,"div",5)(17,"button",10),t.NdJ("click",function(){t.CHM(u);const i=t.oxw();return t.KtG(i.getStudyTests())}),t._uU(18,"\u041d\u0430\u0447\u0430\u0442\u044c"),t.qZA()()()()}if(2&n){const u=t.oxw();t.xp6(5),t.Q6J("ngModel",u.reviewService.targetLang),t.xp6(4),t.Q6J("ngModel",u.reviewService.sourceLang),t.xp6(5),t.Q6J("ngModel",u.reviewService.type),t.xp6(1),t.Q6J("ngForOf",u.testTypes)}}function Et(n,e){1&n&&(t.TgZ(0,"div",12)(1,"label"),t._uU(2," \u0421\u043b\u0430\u0431\u044b\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b. \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u0443\u044e \u0442\u0435\u043c\u0443. "),t.qZA()())}function Ut(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div",13)(1,"p",14),t._uU(2),t.qZA(),t.TgZ(3,"button",15),t.NdJ("click",function(){t.CHM(u);const i=t.oxw();return t.KtG(i.onFinish())}),t._uU(4," \u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c "),t.qZA()()}if(2&n){const u=t.oxw();t.xp6(2),t.AsE("",u.curTestId+1," \u0438\u0437 ",u.reviewService.getTestCount(),"")}}function qt(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"study-study-test",17),t.NdJ("userAnswerEvent",function(i){t.CHM(u);const r=t.oxw(2);return t.KtG(r.addUserAnswer(i))}),t.qZA()}if(2&n){const u=t.oxw(2);t.Q6J("studyTest",u.curTest)}}function Ft(n,e){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,qt,1,1,"study-study-test",16),t.qZA()),2&n){const u=t.oxw();t.xp6(1),t.Q6J("ngIf",u.isShowChild&&!u.isFinish)}}function It(n,e){if(1&n){const u=t.EpF();t.TgZ(0,"div")(1,"button",18),t.NdJ("click",function(){t.CHM(u);const i=t.oxw(2);return t.KtG(i.showResults())}),t._uU(2,"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b"),t.qZA()()}}function Lt(n,e){if(1&n&&(t.TgZ(0,"tr")(1,"th",23),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",24),t._uU(6),t.qZA(),t.TgZ(7,"td",24),t._uU(8),t.qZA(),t.TgZ(9,"td",24),t._uU(10),t.qZA()()),2&n){const u=e.$implicit,s=e.index,i=t.oxw(3);t.xp6(2),t.Oqu(s+1),t.xp6(2),t.hij(" ",i.getTargetLangContent(u.card)," "),t.xp6(2),t.hij(" ",null==u.learningElement.lastRep||null==u.learningElement.lastRep.answer?null:u.learningElement.lastRep.answer.accuracy," "),t.xp6(2),t.hij(" ",null==u.learningElement.lastRep||null==u.learningElement.lastRep.answer?null:u.learningElement.lastRep.answer.retrievability," "),t.xp6(2),t.hij(" ",u.learningElement.nextRep.date.toLocaleDateString()," ")}}function Dt(n,e){if(1&n&&(t.TgZ(0,"div")(1,"div",19)(2,"table",20)(3,"thead")(4,"tr")(5,"th",21),t._uU(6,"#"),t.qZA(),t.TgZ(7,"th",21),t._uU(8,"\u0421\u043b\u043e\u0432\u043e"),t.qZA(),t.TgZ(9,"th",21),t._uU(10,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c"),t.qZA(),t.TgZ(11,"th",21),t._uU(12,"\u041f\u0430\u043c\u044f\u0442\u044c"),t.qZA(),t.TgZ(13,"th",21),t._uU(14,"\u0421\u043b\u0435\u0434. \u0434\u0430\u0442\u0430"),t.qZA()()(),t.TgZ(15,"tbody"),t.YNc(16,Lt,11,5,"tr",22),t.qZA()()()()),2&n){const u=t.oxw(2);t.xp6(16),t.Q6J("ngForOf",u.results)}}function Bt(n,e){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,It,3,0,"div",1),t.YNc(2,Dt,17,1,"div",1),t.qZA()),2&n){const u=t.oxw();t.xp6(1),t.Q6J("ngIf",!u.isShowResults),t.xp6(1),t.Q6J("ngIf",u.isShowResults)}}q.\u0275fac=function(e){return new(e||q)},q.\u0275cmp=t.Xpm({type:q,selectors:[["study-study-test"]],viewQuery:function(e,u){if(1&e&&t.Gf(f,7),2&e){let s;t.iGM(s=t.CRH())&&(u.test=s.first)}},inputs:{studyTest:"studyTest"},outputs:{userAnswerEvent:"userAnswerEvent"},decls:9,vars:1,consts:[[1,"row","justify-content-center"],[1,"col-lg-6"],[1,"text-center",2,"white-space","pre-line"],["studyAnswerTest",""]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"p"),t._uU(4,"\u0412\u043e\u043f\u0440\u043e\u0441:"),t.qZA(),t.TgZ(5,"h4",2),t._uU(6),t.qZA()(),t._UZ(7,"hr"),t.YNc(8,At,0,0,"ng-template",3),t.qZA()()),2&e&&(t.xp6(6),t.hij(" ",u.studyTest.question.content," "))},dependencies:[f]});class F{constructor(e,u){this.reviewService=e,this.studyService=u,this.curTestId=0,this.isShowChild=!1,this.isFinish=!1,this.isShowResults=!1,this.testTypes=["SM2","WRITE"],this.noTests=!1}ngOnInit(){}ngOnDestroy(){this.reviewService.clear()}getStudyTests(){this.reviewService.getStudyTests().subscribe({next:e=>{this.curTest=this.reviewService.getTest(this.curTestId),this.isShowChild=!0},error:e=>{this.noTests=!0,console.error(e)}})}endStudyTests(){this.reviewService.endStudyTests().subscribe({next:e=>{this.isFinish=!0,console.debug("Send!")},error:e=>{console.error(e)}})}addUserAnswer(e){console.debug(e),this.reviewService.addAnswer(e),this.isShowChild=!1,this.curTestId+1!=this.reviewService.getTestCount()?(this.curTestId+=1,this.curTest=this.reviewService.getNextTest(),console.debug(this.curTestId),setTimeout(()=>{this.isShowChild=!0},50)):this.endStudyTests()}onFinish(){this.endStudyTests()}showResults(){let e=[];for(let u of this.reviewService.answers)e.push(u.learningElementId);this.studyService.getStatsByIds(e).subscribe({next:u=>{this.results=u,this.isShowResults=!0,console.debug(u)},error:u=>{console.error(u)}})}getTargetLangContent(e){for(let u of e.sides)if(u.lang==this.reviewService.targetLang)return u.content}}F.\u0275fac=function(e){return new(e||F)(t.Y36(h),t.Y36(g))},F.\u0275cmp=t.Xpm({type:F,selectors:[["study-study-tests"]],decls:9,vars:5,consts:[[1,"mt-3"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","justify-content-between row",4,"ngIf"],[1,"row","my-2"],[1,"col"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"row","my-2","align-items-end"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[3,"ngValue"],[1,"alert","alert-danger"],[1,"justify-content-between","row"],[1,"col-auto"],[1,"btn","btn-success","col-auto","mx-2",3,"click"],[3,"studyTest","userAnswerEvent",4,"ngIf"],[3,"studyTest","userAnswerEvent"],[1,"btn","btn-info",3,"click"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"text-nowrap"]],template:function(e,u){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u0422\u0435\u0441\u0442\u044b"),t.qZA(),t.YNc(3,St,19,4,"div",1),t.YNc(4,Et,3,0,"div",2),t.YNc(5,Ut,5,2,"div",3),t._UZ(6,"hr"),t.YNc(7,Ft,2,1,"div",1),t.YNc(8,Bt,3,2,"div",1),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf",!u.curTest),t.xp6(1),t.Q6J("ngIf",u.noTests),t.xp6(1),t.Q6J("ngIf",!u.isFinish&&u.curTest),t.xp6(2),t.Q6J("ngIf",u.curTest),t.xp6(1),t.Q6J("ngIf",u.isFinish))},dependencies:[l.sg,l.O5,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,q]});const kt=[{path:"",component:x,canActivate:[T],canActivateChild:[T],children:[{path:"",component:A},{path:"courses",component:b},{path:"course/:id",component:y},{path:"test",component:F},{path:"stats/ltopic/:lTopicId",component:E},{path:"stats/lelement/:lElementId",component:S}]}];class v{}v.\u0275fac=function(e){return new(e||v)},v.\u0275mod=t.oAB({type:v}),v.\u0275inj=t.cJS({imports:[c.Bz.forChild(kt),c.Bz]});class C{}C.\u0275fac=function(e){return new(e||C)},C.\u0275mod=t.oAB({type:C}),C.\u0275inj=t.cJS({imports:[l.ez,v,p.IJ,a.u5,a.UX,k.JF]})}}]);