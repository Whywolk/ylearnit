"use strict";(self.webpackChunkylearnit_angular=self.webpackChunkylearnit_angular||[]).push([[752],{7752:(Be,M,a)=>{a.r(M),a.d(M,{StudyModule:()=>C});var c=a(6895),N=a(529),l=a(433),p=a(7747),o=a(4166),e=a(1571),J=a(3743);class T{constructor(t,n){this.authService=t,this.router=n}canActivate(t,n){return!!this.authService.isAuth()||this.router.createUrlTree(["/login"])}canActivateChild(t,n){return!!this.authService.isAuth()||this.router.createUrlTree(["/login"])}}T.\u0275fac=function(t){return new(t||T)(e.LFG(J.e),e.LFG(o.F0))},T.\u0275prov=e.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"});var I=a(4004);class ${constructor(t){this.id=t.id,this.accuracy=t.accuracy,this.retrievability=t.retrievability,this.thinkingTime=t.idleSeconds,this.totalTime=t.totalSeconds,this.date=new Date(t.date)}}class Z{constructor(t){this.id=t.id,this.loop=t.loop,this.serialNumber=t.serialNumber,this.date=new Date(t.date),this.interval=t.interval,t.answer&&(this.answer=new $(t.answer))}}class j{constructor(t){this.id=t.id,this.element=t.element,t.lastRep&&(this.lastRep=new Z(t.lastRep)),this.nextRep=new Z(t.nextRep)}}class G{constructor(t){this.id=t.id,this.element=t.element,t.lastRep&&(this.lastRep=new Z(t.lastRep)),this.nextRep=new Z(t.nextRep),this.repetitions=t.repetitions.map(n=>new Z(n))}}var H=a(1133);class g{constructor(t,n){this.appConfig=t,this.http=n,this.studyUrl="/study"}getCourseById(t){return this.http.get(`${this.getApiUrl()}/course/${t}`)}getCoursesByTargetLang(t){return this.http.get(`${this.getApiUrl()}/courses`,{params:{targetLang:t,sourceLang:"ru"}})}addCourse(t){return this.http.post(`${this.getApiUrl()}/course/${t}`,{})}getLearningCourseById(t){return this.http.get(`${this.getApiUrl()}/lcourse/${t}`)}getLearningCoursesByTargetLang(t){return this.http.get(`${this.getApiUrl()}/lcourses/${t}`)}addTopicForLearningCourse(t,n){return this.http.post(`${this.getApiUrl()}/lcourse/${t}/${n}`,{})}getStudyTests(t,n,s="SM2"){let i=`${this.getApiUrl()}/tests`;return this.http.get(i,{params:{targetLang:t,sourceLang:n,testType:s}})}getStudyTestsByTopics(t,n,s,i="SM2"){let r=`${this.getApiUrl()}/tests`;return this.http.get(r,{params:{targetLang:t,sourceLang:n,ltIds:s,testType:i}})}endStudyTests(t){return this.http.post(`${this.getApiUrl()}/tests`,t)}getStatsByIds(t){return this.http.get(`${this.getApiUrl()}/stats`,{params:{leIds:t,sourceLang:"ru"}}).pipe((0,I.U)(n=>n.map(i=>{let r=i;return r.learningElement=new G(r.learningElement),r})))}getStatsByLearningTopic(t,n=0){return this.http.get(`${this.getApiUrl()}/stats/byLearningTopic/${t}`,{params:{page:n}}).pipe((0,I.U)(s=>s.map(r=>{let d=r;return d.learningElement=new j(d.learningElement),d})))}getApiUrl(){return this.appConfig.apiUrl+this.studyUrl}}g.\u0275fac=function(t){return new(t||g)(e.LFG(H._),e.LFG(N.eN))},g.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"});var B=a(8505);class h{constructor(t){this.studyService=t,this._tests=[],this._answers=[],this._curTest=0,this._lTopicIds=[],this._finished=!1,this._testType="SM2"}getStudyTests(){if(this._targetLang&&this._sourceLang)return 0==this._lTopicIds.length?this.studyService.getStudyTests(this._targetLang,this._sourceLang,this._testType).pipe((0,B.b)(t=>{this._tests=t,this._answers=[],this._curTest=0,console.debug(t)})):this.studyService.getStudyTestsByTopics(this._targetLang,this._sourceLang,this._lTopicIds,this._testType).pipe((0,B.b)(t=>{this._tests=t,this._answers=[],this._curTest=0,console.debug(t)}));throw new Error("Target lang or source lang not setted")}endStudyTests(){return this.studyService.endStudyTests(this._answers).pipe((0,B.b)(t=>{this._finished=!0}))}onReview(){this.clear(),this.targetLang="",this.sourceLang=""}onReviewByCourse(t){this.clear();let n=[];for(let s of t.topics)s.added&&n.push(s.lTopicId);this.learningTopicIds=n,this.targetLang=t.targetLang,this.sourceLang=t.sourceLang}onReviewByTopic(t,n){this.clear(),this.learningTopicIds=[n.lTopicId],this.targetLang=t.targetLang,this.sourceLang=t.sourceLang}getTestCount(){return this._tests.length}getTest(t){return this._tests[t]}getCurTest(){return this._tests[this._curTest]}getNextTest(){return this._curTest+1<this._tests.length&&(this._curTest+=1),this._tests[this._curTest]}get tests(){return this._tests}addAnswer(t){this._answers.push(t)}get answers(){return this._answers}get learningTopicIds(){return this._lTopicIds}set learningTopicIds(t){this._lTopicIds=t}get targetLang(){return this._targetLang}set targetLang(t){this._targetLang=t}get sourceLang(){return this._sourceLang}set sourceLang(t){this._sourceLang=t}get finished(){return this._finished}get type(){return this._testType}set type(t){this._testType=t}clear(){this._tests=[],this._answers=[],this._lTopicIds=[],this._curTest=0,this._finished=!1,this._testType="SM2"}}function W(u,t){1&u&&(e.TgZ(0,"button",8),e._uU(1,"\u0418\u0437\u0443\u0447\u0430\u0435\u0442\u0441\u044f"),e.qZA())}function K(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.addCourse())}),e._uU(1,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),e.qZA()}if(2&u){const n=e.oxw(2);e.Q6J("disabled",n.isDisabledButtons)}}function X(u,t){1&u&&(e.TgZ(0,"span",13),e._uU(1,"\u0438\u0437\u0443\u0447\u0430\u0435\u0442\u0441\u044f"),e.qZA())}function P(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div")(1,"button",14),e._uU(2," \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 "),e.qZA(),e.TgZ(3,"button",15),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.onReviewByTopic(r.course,i))}),e._uU(4," \u041f\u0440\u043e\u0439\u0442\u0438 \u0442\u0435\u0441\u0442 "),e.qZA()()}if(2&u){const n=e.oxw().$implicit;e.xp6(1),e.MGl("routerLink","/app/stats/ltopic/",n.lTopicId,"")}}function z(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div")(1,"button",16),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.addTopic(i))}),e._uU(2,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),e.qZA()()}if(2&u){const n=e.oxw(3);e.xp6(1),e.Q6J("disabled",n.isDisabledButtons)}}function V(u,t){if(1&u&&(e.TgZ(0,"div",1)(1,"div",10)(2,"div",11)(3,"h5"),e._uU(4),e.YNc(5,X,2,0,"span",12),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"p"),e._uU(9),e.qZA(),e.YNc(10,P,5,1,"div",0),e.YNc(11,z,3,1,"div",0),e.qZA()()()),2&u){const n=t.$implicit,s=e.oxw(2);e.xp6(4),e.hij("\u0422\u0435\u043c\u0430: ",n.title," "),e.xp6(1),e.Q6J("ngIf",n.added),e.xp6(2),e.hij("\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: ",n.difficult,""),e.xp6(2),e.Oqu(n.description),e.xp6(1),e.Q6J("ngIf",n.added),e.xp6(1),e.Q6J("ngIf",s.course.added&&!n.added)}}function ee(u,t){if(1&u&&(e.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e._uU(5),e.qZA()(),e.YNc(6,W,2,0,"button",4),e.YNc(7,K,2,1,"button",5),e.qZA(),e.TgZ(8,"div")(9,"p"),e._uU(10,"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u044f\u0437\u044b\u043a: "),e.TgZ(11,"span",6),e._uU(12),e.qZA()(),e.TgZ(13,"p"),e._uU(14,"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u044f\u0437\u044b\u043a: "),e.TgZ(15,"span",6),e._uU(16),e.qZA()(),e.TgZ(17,"p"),e._uU(18),e.qZA(),e.TgZ(19,"p"),e._uU(20),e.qZA()()(),e.YNc(21,V,12,6,"div",7),e.qZA()),2&u){const n=e.oxw();e.xp6(5),e.Oqu(n.course.title),e.xp6(1),e.Q6J("ngIf",n.course.added),e.xp6(1),e.Q6J("ngIf",!n.course.added),e.xp6(5),e.Oqu(n.course.targetLang),e.xp6(4),e.Oqu(n.course.sourceLang),e.xp6(2),e.hij("\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: ",n.course.difficult,""),e.xp6(2),e.Oqu(n.course.description),e.xp6(1),e.Q6J("ngForOf",n.course.topics)}}h.\u0275fac=function(t){return new(t||h)(e.LFG(g))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"});class y{constructor(t,n,s,i){this.studyService=t,this.reviewService=n,this.route=s,this.router=i,this.isDisabledButtons=!1}ngOnInit(){this.getCourse(this.route.snapshot.params.id)}getCourse(t){this.studyService.getCourseById(t).subscribe({next:n=>{this.course=n,console.log(n)},error:n=>{console.error(n)}})}addCourse(){this.course&&(this.isDisabledButtons=!0,this.studyService.addCourse(this.course.id).subscribe({next:t=>{this.ngOnInit(),this.isDisabledButtons=!1},error:t=>{console.log(t)}}))}addTopic(t){this.course&&t&&(this.isDisabledButtons=!0,this.studyService.addTopicForLearningCourse(this.course.lCourseId,t.id).subscribe({next:n=>{this.ngOnInit(),this.isDisabledButtons=!1},error:n=>{console.log(n)}}))}onReviewByCourse(t){t.added&&(this.reviewService.onReviewByCourse(t),console.debug("by course="+t.lCourseId),this.router.navigate(["/app/test"]))}onReviewByTopic(t,n){t.added&&n.added&&(this.reviewService.onReviewByTopic(t,n),console.debug("by topic="+n.lTopicId),this.router.navigate(["/app/test"]))}}y.\u0275fac=function(t){return new(t||y)(e.Y36(g),e.Y36(h),e.Y36(o.gz),e.Y36(o.F0))},y.\u0275cmp=e.Xpm({type:y,selectors:[["study-course-details"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"m-2"],[1,"row"],[1,"col-auto"],["class","col-3 btn btn-info disabled",4,"ngIf"],["class","col-3 btn btn-info",3,"disabled","click",4,"ngIf"],[1,"badge","bg-secondary"],["class","m-2",4,"ngFor","ngForOf"],[1,"col-3","btn","btn-info","disabled"],[1,"col-3","btn","btn-info",3,"disabled","click"],[1,"card"],[1,"card-body"],["class","badge bg-info",4,"ngIf"],[1,"badge","bg-info"],[1,"btn","btn-primary",3,"routerLink"],[1,"btn","btn-primary","mx-2",3,"click"],[1,"btn","btn-info",3,"disabled","click"]],template:function(t,n){1&t&&e.YNc(0,ee,22,8,"div",0),2&t&&e.Q6J("ngIf",n.course)},dependencies:[c.sg,c.O5,o.rH]});var R=a(7579),te=a(1566),ne=a(4482),ue=a(5403),ie=a(1884),re=a(9300),oe=a(6451);const ae=["instance"];function le(u,t){if(1&u&&(e.TgZ(0,"a",12),e._uU(1,"learning"),e.qZA()),2&u){const n=e.oxw().$implicit;e.MGl("routerLink","../course/",n.id,"")}}function ce(u,t){if(1&u&&(e.TgZ(0,"div",7)(1,"div",8)(2,"a",9),e._uU(3),e.qZA(),e.YNc(4,le,2,1,"a",10),e.qZA(),e.TgZ(5,"div",11)(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"p"),e._uU(9),e.qZA()()()),2&u){const n=t.$implicit;e.xp6(2),e.MGl("routerLink","../course/",n.id,""),e.xp6(1),e.Oqu(n.title),e.xp6(1),e.Q6J("ngIf",n.added),e.xp6(3),e.hij("\u0412\u0441\u0435\u0433\u043e \u0442\u0435\u043c: ",n.topics.length,""),e.xp6(2),e.hij("\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c: ",n.difficult,"")}}const O=[{code:"en",name:"\u0410\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439"}];class b{constructor(t){this.studyService=t,this.formatter=n=>n.name,this.focus$=new R.x,this.click$=new R.x,this.search=n=>{const s=n.pipe(function se(u,t=te.z){return(0,ne.e)((n,s)=>{let i=null,r=null,d=null;const w=()=>{if(i){i.unsubscribe(),i=null;const _=r;r=null,s.next(_)}};function k(){const _=d+u,D=t.now();if(D<_)return i=this.schedule(void 0,_-D),void s.add(i);w()}n.subscribe((0,ue.x)(s,_=>{r=_,d=t.now(),i||(i=t.schedule(k,u),s.add(i))},()=>{w(),s.complete()},void 0,()=>{r=i=null}))})}(200),(0,ie.x)()),i=this.click$.pipe((0,re.h)(()=>!this.instance.isPopupOpen()));return(0,oe.T)(s,this.focus$,i).pipe((0,I.U)(d=>""===d?O:O.filter(w=>new RegExp(d,"mi").test(w.name)).slice(0,10)))}}ngOnInit(){}getCourses(){this.langField&&this.studyService.getCoursesByTargetLang(this.langField.code).subscribe({next:t=>{this.courses=t,console.debug(t)},error:t=>{console.error(t)}})}}function de(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"a",5),e._uU(3),e.qZA()(),e.TgZ(4,"div",6)(5,"button",7),e.NdJ("click",function(){const r=e.CHM(n).$implicit,d=e.oxw(2);return e.KtG(d.onReviewByCourse(r))}),e._uU(6,"\u041f\u0440\u043e\u0439\u0442\u0438 \u0442\u0435\u0441\u0442"),e.qZA()()()}if(2&u){const n=t.$implicit,s=t.index;e.xp6(2),e.MGl("routerLink","./course/",n.id,""),e.xp6(1),e.AsE(" ",s+1,") ",n.title," ")}}function pe(u,t){if(1&u&&(e.TgZ(0,"div"),e.YNc(1,de,7,3,"div",2),e.qZA()),2&u){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.learningCourses)}}function ge(u,t){1&u&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"\u041a\u0443\u0440\u0441\u044b \u043d\u0435 "),e.TgZ(3,"a",8),e._uU(4,"\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b"),e.qZA()()())}b.\u0275fac=function(t){return new(t||b)(e.Y36(g))},b.\u0275cmp=e.Xpm({type:b,selectors:[["study-courses-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(ae,7),2&t){let s;e.iGM(s=e.CRH())&&(n.instance=s.first)}},decls:16,vars:7,consts:[[1,"mt-3"],[1,"row"],[1,"col-auto"],["type","text",1,"form-control",3,"ngModel","ngbTypeahead","editable","inputFormatter","resultFormatter","ngModelChange","focus","click"],["instance","ngbTypeahead"],[1,"btn","btn-info",3,"disabled","click"],["class","card my-3",4,"ngFor","ngForOf"],[1,"card","my-3"],[1,"card-header"],[1,"card-title","link-info","h5",3,"routerLink"],["class","btn badge bg-info ms-3",3,"routerLink",4,"ngIf"],[1,"card-body","justify-content-between"],[1,"btn","badge","bg-info","ms-3",3,"routerLink"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"\u041a\u0443\u0440\u0441\u044b"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",1)(5,"div",2)(6,"label"),e._uU(7,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u044f\u0437\u044b\u043a:"),e.qZA()(),e.TgZ(8,"div",2)(9,"input",3,4),e.NdJ("ngModelChange",function(i){return n.langField=i})("focus",function(i){return n.focus$.next(i.target.value)})("click",function(i){return n.click$.next(i.target.value)}),e.qZA()(),e.TgZ(11,"div",2)(12,"button",5),e.NdJ("click",function(){return n.getCourses()}),e._uU(13,"\u041d\u0430\u0439\u0442\u0438"),e.qZA()()(),e._UZ(14,"hr"),e.YNc(15,ce,10,5,"div",6),e.qZA()),2&t&&(e.xp6(9),e.Q6J("ngModel",n.langField)("ngbTypeahead",n.search)("editable",!1)("inputFormatter",n.formatter)("resultFormatter",n.formatter),e.xp6(3),e.Q6J("disabled",!(null!=n.langField&&n.langField.code)),e.xp6(3),e.Q6J("ngForOf",n.courses))},dependencies:[c.sg,c.O5,o.rH,p.dR,l.Fj,l.JJ,l.On]});class A{constructor(t,n,s){this.studyService=t,this.reviewService=n,this.router=s}ngOnInit(){this.studyService.getLearningCoursesByTargetLang("en").subscribe({next:t=>{this.learningCourses=t,console.debug(t)},error:t=>{console.error(t)}})}onReviewByCourse(t){t.added&&(this.reviewService.onReviewByCourse(t),console.debug("by course="+t.id),this.router.navigate(["/app/test"]))}}A.\u0275fac=function(t){return new(t||A)(e.Y36(g),e.Y36(h),e.Y36(o.F0))},A.\u0275cmp=e.Xpm({type:A,selectors:[["study-dashboard"]],decls:5,vars:2,consts:[[1,"mt-3"],[4,"ngIf"],["class","card my-3",4,"ngFor","ngForOf"],[1,"card","my-3"],[1,"card-header"],[1,"link","link-info","h5",3,"routerLink"],[1,"card-body"],[1,"btn","btn-primary",3,"click"],["routerLink","./courses"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043a\u0443\u0440\u0441\u044b"),e.qZA(),e.YNc(3,pe,2,1,"div",1),e.YNc(4,ge,5,0,"div",1),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.learningCourses),e.xp6(1),e.Q6J("ngIf",0==(null==n.learningCourses?null:n.learningCourses.length)))},dependencies:[c.sg,c.O5,o.rH]});class x{constructor(t,n){this.authService=t,this.router=n,this.isMenuCollapsed=!0,this.username=localStorage.getItem("userName"),this.brand="YLearnIt",this.easter()}onLogOut(){console.log("Log out"),this.authService.logout(),this.router.navigate(["/login"])}easter(){Math.random()<.1&&(this.brand="\u3088\u3057! LearnIt!")}}function he(u,t){if(1&u&&(e.TgZ(0,"tr")(1,"th",6),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA()()),2&u){const n=t.$implicit,s=t.index;e.xp6(2),e.Oqu(s+1),e.xp6(2),e.hij(" ",n.contentId," "),e.xp6(2),e.hij(" ",n.content," "),e.xp6(2),e.hij(" ",n.lang," "),e.xp6(2),e.hij(" ",n.sideType," ")}}function _e(u,t){if(1&u&&(e.TgZ(0,"tr")(1,"th",6),e._uU(2),e.qZA(),e.TgZ(3,"th",6),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",7),e._uU(8),e.qZA(),e.TgZ(9,"td",7),e._uU(10),e.qZA(),e.TgZ(11,"td",7),e._uU(12),e.qZA(),e.TgZ(13,"td",7),e._uU(14),e.qZA(),e.TgZ(15,"td",7),e._uU(16),e.qZA()()),2&u){const n=t.$implicit;e.xp6(2),e.hij(" ",n.loop," "),e.xp6(2),e.hij(" ",n.serialNumber," "),e.xp6(2),e.hij(" ",n.interval," "),e.xp6(2),e.hij(" ",n.date.toLocaleDateString()," "),e.xp6(2),e.hij(" ",null==n.answer||null==n.answer.date?null:n.answer.date.toLocaleString()," "),e.xp6(2),e.hij(" ",null==n.answer?null:n.answer.accuracy," "),e.xp6(2),e.hij(" ",null==n.answer?null:n.answer.retrievability," "),e.xp6(2),e.hij(" ",null==n.answer?null:n.answer.thinkingTime," ")}}function Te(u,t){if(1&u&&(e.TgZ(0,"div")(1,"h4"),e._uU(2,"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430"),e.qZA(),e.TgZ(3,"div",2)(4,"table",3)(5,"thead")(6,"tr")(7,"th",4),e._uU(8,"#"),e.qZA(),e.TgZ(9,"th",4),e._uU(10,"CID"),e.qZA(),e.TgZ(11,"th",4),e._uU(12,"\u0421\u043b\u043e\u0432\u043e"),e.qZA(),e.TgZ(13,"th",4),e._uU(14,"\u042f\u0437\u044b\u043a"),e.qZA(),e.TgZ(15,"th",4),e._uU(16,"\u0422\u0438\u043f \u0441\u0442\u043e\u0440\u043e\u043d\u044b"),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,he,11,5,"tr",5),e.qZA()()(),e._UZ(19,"hr"),e.TgZ(20,"h4"),e._uU(21,"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f"),e.qZA(),e.TgZ(22,"div",2)(23,"table",3)(24,"thead")(25,"tr")(26,"th",4),e._uU(27,"\u041a\u0440\u0443\u0433"),e.qZA(),e.TgZ(28,"th",4),e._uU(29,"\u041d\u043e\u043c\u0435\u0440"),e.qZA(),e.TgZ(30,"th",4),e._uU(31,"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b"),e.qZA(),e.TgZ(32,"th",4),e._uU(33,"\u0414\u0430\u0442\u0430 \u043f\u043e\u0432\u0442\u043e\u0440\u0430"),e.qZA(),e.TgZ(34,"th",4),e._uU(35,"\u0414\u0430\u0442\u0430 \u043e\u0442\u0432\u0435\u0442\u0430"),e.qZA(),e.TgZ(36,"th",4),e._uU(37,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c, %"),e.qZA(),e.TgZ(38,"th",4),e._uU(39,"\u041f\u0430\u043c\u044f\u0442\u044c, %"),e.qZA(),e.TgZ(40,"th",4),e._uU(41,"\u0412\u0440\u0435\u043c\u044f (\u0441\u0435\u043a.)"),e.qZA()()(),e.TgZ(42,"tbody"),e.YNc(43,_e,17,8,"tr",5),e.qZA()()()()),2&u){const n=e.oxw();e.xp6(18),e.Q6J("ngForOf",n.learningCard.card.sides),e.xp6(25),e.Q6J("ngForOf",n.learningCard.learningElement.repetitions)}}x.\u0275fac=function(t){return new(t||x)(e.Y36(J.e),e.Y36(o.F0))},x.\u0275cmp=e.Xpm({type:x,selectors:[["study-home"]],decls:26,vars:3,consts:[[1,"d-flex","flex-column","bg-light","min-vh-100"],[1,"navbar","shadow","sticky-top","navbar-expand-md","navbar-dark","bg-dark"],[1,"container"],["routerLink","/app",1,"navbar-brand"],["type","button",1,"navbar-toggler",3,"click"],[1,"collapse","navbar-collapse","justify-content-between",3,"ngbCollapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","./courses",1,"nav-link",3,"click"],["routerLink","./test",1,"nav-link",3,"click"],["ngbDropdown","",1,"nav-item","mr-auto"],["type","button","ngbDropdownToggle","",1,"nav-link"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end","dropdown-menu-dark"],["ngbDropdownItem","",3,"click"],[1,"row","min-vh-100","justify-content-center"],[1,"col-lg-8","bg-white"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"div",2)(3,"a",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return n.isMenuCollapsed=!n.isMenuCollapsed}),e._uU(6," \u2630 "),e.qZA(),e.TgZ(7,"div",5)(8,"ul",6)(9,"li",7)(10,"a",8),e.NdJ("click",function(){return n.isMenuCollapsed=!0}),e._uU(11,"\u041a\u0443\u0440\u0441\u044b"),e.qZA()(),e.TgZ(12,"li",7)(13,"a",9),e.NdJ("click",function(){return n.isMenuCollapsed=!0}),e._uU(14,"\u0422\u0435\u0441\u0442\u044b"),e.qZA()()(),e.TgZ(15,"ul",6)(16,"li",10)(17,"a",11),e._uU(18),e.qZA(),e.TgZ(19,"div",12)(20,"button",13),e.NdJ("click",function(){return n.onLogOut()}),e._uU(21,"\u0412\u044b\u0439\u0442\u0438"),e.qZA()()()()()()(),e.TgZ(22,"div",2)(23,"div",14)(24,"div",15),e._UZ(25,"router-outlet"),e.qZA()()()()),2&t&&(e.xp6(4),e.Oqu(n.brand),e.xp6(3),e.Q6J("ngbCollapse",n.isMenuCollapsed),e.xp6(11),e.Oqu(n.username))},dependencies:[o.lC,o.rH,p._D,p.jt,p.iD,p.Vi,p.TH,p.M2]});class S{constructor(t,n,s){this.studyService=t,this.route=n,this.router=s}ngOnInit(){this.leId=this.route.snapshot.params.lElementId,this.leId&&this.studyService.getStatsByIds([this.leId]).subscribe({next:t=>{t.length>0&&(this.learningCard=t[0],console.debug(t))},error:t=>{console.error(t)}})}}function me(u,t){if(1&u&&(e.TgZ(0,"tr")(1,"th",6),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",7),e._uU(5),e.qZA()(),e.TgZ(6,"td",8),e._uU(7),e.qZA(),e.TgZ(8,"td",8),e._uU(9),e.qZA(),e.TgZ(10,"td",8),e._uU(11),e.qZA(),e.TgZ(12,"td",8),e._uU(13),e.qZA()()),2&u){const n=t.$implicit,s=t.index,i=e.oxw();e.xp6(2),e.Oqu(s+1),e.xp6(2),e.MGl("routerLink","../../lelement/",n.learningElement.id,""),e.xp6(1),e.hij(" ",i.getContent(n.card,n.learningElement.element.targetLang)," "),e.xp6(2),e.hij(" ",null==n.learningElement.lastRep||null==n.learningElement.lastRep.answer?null:n.learningElement.lastRep.answer.accuracy," "),e.xp6(2),e.hij(" ",null==n.learningElement.lastRep||null==n.learningElement.lastRep.answer?null:n.learningElement.lastRep.answer.retrievability," "),e.xp6(2),e.hij(" ",null==n.learningElement.lastRep||null==n.learningElement.lastRep.answer||null==n.learningElement.lastRep.answer.date?null:n.learningElement.lastRep.answer.date.toLocaleString()," "),e.xp6(2),e.hij(" ",i.getLocaleDateString(n.learningElement.nextRep.date)," ")}}function fe(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.getNextPage())}),e._uU(2,"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435"),e.qZA()()}}S.\u0275fac=function(t){return new(t||S)(e.Y36(g),e.Y36(o.gz),e.Y36(o.F0))},S.\u0275cmp=e.Xpm({type:S,selectors:[["study-learning-card-details"]],decls:5,vars:1,consts:[[1,"mt-3"],[4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"text-nowrap"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0438\u0437\u0443\u0447\u0430\u0435\u043c\u043e\u043c\u0443 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0443"),e.qZA(),e._UZ(3,"hr"),e.YNc(4,Te,44,2,"div",1),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.learningCard))},dependencies:[c.sg,c.O5]});class E{constructor(t,n,s){this.studyService=t,this.route=n,this.router=s,this.learningCards=[],this.page=0,this.hasPages=!0}ngOnInit(){this.lTopicId=this.route.snapshot.params.lTopicId,this.lTopicId&&this.getByPage(this.lTopicId,this.page)}getContent(t,n){for(let s of t.sides)if(s.lang===n)return s.content}getByPage(t,n){this.studyService.getStatsByLearningTopic(t,n).subscribe({next:s=>{s.length>0?(this.learningCards=this.learningCards.concat(s),this.page+=1,console.debug(s)):this.hasPages=!1},error:s=>{console.error(s)}})}getNextPage(){this.lTopicId&&this.page&&this.getByPage(this.lTopicId,this.page)}getLocaleDateString(t){let n=new Date(t),s=new Date,i=n.getTime()-s.getTime(),r=Math.ceil(i/864e5);return 0==r?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":1==r?"\u0417\u0430\u0432\u0442\u0440\u0430":r<=31&&r>0?`\u0427\u0435\u0440\u0435\u0437 ${r} \u0434\u043d\u0435\u0439`:n.toLocaleDateString()}}E.\u0275fac=function(t){return new(t||E)(e.Y36(g),e.Y36(o.gz),e.Y36(o.F0))},E.\u0275cmp=e.Xpm({type:E,selectors:[["study-learning-card-list"]],decls:22,vars:2,consts:[[1,"mt-3"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],["class","text-center my-3",4,"ngIf"],["scope","row"],[1,"link","link-primary",3,"routerLink"],[1,"text-nowrap"],[1,"text-center","my-3"],[1,"btn","btn-primary",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0442\u0435\u043c\u0435"),e.qZA(),e.TgZ(3,"div",1)(4,"table",2)(5,"thead")(6,"tr")(7,"th",3),e._uU(8,"#"),e.qZA(),e.TgZ(9,"th",3),e._uU(10,"\u0421\u043b\u043e\u0432\u043e"),e.qZA(),e.TgZ(11,"th",3),e._uU(12,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c, %"),e.qZA(),e.TgZ(13,"th",3),e._uU(14,"\u041f\u0430\u043c\u044f\u0442\u044c, %"),e.qZA(),e.TgZ(15,"th",3),e._uU(16,"\u041f\u043e\u0441\u043b. \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0435"),e.qZA(),e.TgZ(17,"th",3),e._uU(18,"\u0421\u043b\u0435\u0434. \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0435"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,me,14,7,"tr",4),e.qZA()()(),e.YNc(21,fe,3,0,"div",5),e.qZA()),2&t&&(e.xp6(20),e.Q6J("ngForOf",n.learningCards),e.xp6(1),e.Q6J("ngIf",n.hasPages))},dependencies:[c.sg,c.O5,o.rH]});class Y{constructor(t,n,s,i,r,d,w,k,_,D){this.testAnswers=t,this.userAnswer=n,this.type=s,this.thinkingTime=i,this.totalTime=r,this.dbName=d,this.elementIdDb=w,this.learningElementId=k,this.repetitionId=_,this.data=D}}class Q{constructor(t,n,s,i,r,d){this.contentId=t,this.content=n,this.contentType=s,this.lang=i,this.sideType=r,this.variants=d}}function ve(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div")(1,"p"),e._uU(2,"\u041e\u0442\u0432\u0435\u0442?"),e.qZA(),e.TgZ(3,"div",1)(4,"button",2),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showAnswer())}),e._uU(5,"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0442\u0432\u0435\u0442"),e.qZA()()()}}function Ce(u,t){if(1&u&&(e.TgZ(0,"h4",1),e._uU(1),e.qZA()),2&u){const n=t.$implicit;e.xp6(1),e.Oqu(n.content)}}function we(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){const r=e.CHM(n).$implicit,d=e.oxw(2);return e.KtG(d.onMark(r))}),e._uU(1),e.qZA()}if(2&u){const n=t.$implicit;e.xp6(1),e.hij(" ",n," ")}}function Ze(u,t){if(1&u&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"\u041e\u0442\u0432\u0435\u0442:"),e.qZA(),e.YNc(3,Ce,2,1,"h4",3),e._UZ(4,"hr"),e.TgZ(5,"div")(6,"label"),e._uU(7,"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u043e\u0442\u0432\u0435\u0442:"),e.qZA(),e.TgZ(8,"div",4)(9,"button",5),e._uU(10,"?"),e.qZA(),e.TgZ(11,"div",6)(12,"label",7),e._uU(13,"5 \u2013 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442"),e.qZA(),e.TgZ(14,"label",7),e._uU(15,"4 \u2013 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u043f\u043e\u0441\u043b\u0435 \u043a\u043e\u043b\u0435\u0431\u0430\u043d\u0438\u044f"),e.qZA(),e.TgZ(16,"label",7),e._uU(17,"3 \u2013 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u0432\u0441\u043f\u043e\u043c\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0432 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u0442\u0440\u0443\u0434\u043e\u043c"),e.qZA(),e.TgZ(18,"label",7),e._uU(19,"2 \u2013 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442, \u0433\u0434\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043a\u0430\u0437\u0430\u043b\u043e\u0441\u044c \u043b\u0435\u0433\u043a\u043e \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u0442\u044c"),e.qZA(),e.TgZ(20,"label",7),e._uU(21,"1 \u2013 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442, \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u043b"),e.qZA(),e.TgZ(22,"label",7),e._uU(23,"0 \u2013 \u043d\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430, \u043d\u0435 \u0437\u0430\u043f\u043e\u043c\u043d\u0438\u043b\u0441\u044f"),e.qZA()()()(),e.TgZ(24,"div",8),e.YNc(25,we,2,1,"button",9),e.qZA()()),2&u){const n=e.oxw();e.xp6(3),e.Q6J("ngForOf",n.studyTest.answers),e.xp6(22),e.Q6J("ngForOf",n.sm2Marks)}}class m{constructor(){this.userAnswerEvent=new e.vpe,this.isShowAnswer=!1,this.sm2Marks=["0","1","2","3","4","5"]}ngOnInit(){this.start=new Date,this.isShowAnswer=!1,this.curMark=void 0,console.debug("Start="+this.start)}showAnswer(){this.isShowAnswer=!0,this.end=new Date,console.debug("End="+this.end),console.debug("Total=",this.end.getTime()-this.start.getTime())}onMark(t){this.curMark=t,this.onNext()}onNext(){if(this.curMark){let t=Math.round((this.end.getTime()-this.start.getTime())/1e3),s=this.buildUserAnswer(this.curMark,t,t);this.userAnswerEvent.emit(s)}}buildUserAnswer(t,n,s){let i=new Q(-1,t,"TEXT_PLAIN","en","USER_ANSWER",[]);return new Y(this.studyTest.answers,i,"SM2",n,s,this.studyTest.dbName,this.studyTest.elementIdDb,this.studyTest.learningElementId,this.studyTest.repetitionId,"")}}m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=e.Xpm({type:m,selectors:[["study-sm2-test"]],inputs:{studyTest:"studyTest"},outputs:{userAnswerEvent:"userAnswerEvent"},decls:3,vars:2,consts:[[4,"ngIf"],[1,"text-center"],[1,"btn","btn-info",3,"click"],["class","text-center",4,"ngFor","ngForOf"],["ngbDropdown","",1,"my-4"],["ngbDropdownToggle","",1,"btn","btn-info"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",1,"text-wrap"],[1,"row"],["class","btn btn-primary mx-2 col",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-primary","mx-2","col",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div"),e.YNc(1,ve,6,0,"div",0),e.YNc(2,Ze,26,2,"div",0),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.isShowAnswer),e.xp6(1),e.Q6J("ngIf",n.isShowAnswer))},dependencies:[c.sg,c.O5,p.jt,p.iD,p.Vi,p.TH]});class f{constructor(t){this.viewContainerRef=t}}function ye(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div")(1,"p"),e._uU(2,"\u041e\u0442\u0432\u0435\u0442?"),e.qZA(),e.TgZ(3,"form",1),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onAnswerSubmit())}),e.TgZ(4,"div",2)(5,"div",3)(6,"input",4),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onAnswerChange(i))}),e.qZA()(),e.TgZ(7,"div",5)(8,"button",6),e._uU(9,"\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c"),e.qZA()()()()()}if(2&u){const n=e.oxw();e.xp6(3),e.Q6J("formGroup",n.answer)}}function be(u,t){if(1&u&&(e.TgZ(0,"h4",7),e._uU(1),e.qZA()),2&u){const n=t.$implicit;e.xp6(1),e.Oqu(n.content)}}function Ae(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div")(1,"p"),e._uU(2,"\u0412\u0430\u0448 \u043e\u0442\u0432\u0435\u0442:"),e.qZA(),e.TgZ(3,"h4",7),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6,"\u041e\u0442\u0432\u0435\u0442:"),e.qZA(),e.YNc(7,be,2,1,"h4",8),e.TgZ(8,"button",9),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onNext())}),e._uU(9,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043e\u0442\u0432\u0435\u0442"),e.qZA()()}if(2&u){const n=e.oxw();e.xp6(4),e.Oqu(n.answer.controls.answer.value),e.xp6(3),e.Q6J("ngForOf",n.studyTest.answers)}}f.\u0275fac=function(t){return new(t||f)(e.Y36(e.s_b))},f.\u0275dir=e.lG2({type:f,selectors:[["","studyAnswerTest",""]]});class U{constructor(t){this.fb=t,this.WRITE_DELTA_MS=1e3,this.userAnswerEvent=new e.vpe,this.isShowAnswer=!1,this.changeTimestamps=[],this.answer=this.fb.group({answer:new l.NI("")})}ngOnInit(){this.isShowAnswer=!1,this.changeTimestamps.push(new Date)}onAnswerChange(t){this.changeTimestamps.push(new Date)}onAnswerSubmit(){this.changeTimestamps.push(new Date),this.isShowAnswer=!0}onNext(){let t=this.calcDeltaList(this.changeTimestamps),n=this.calcTotalTime(t),s=this.calcThinkingTime(t),i=this.buildUserAnswer(this.answer.controls.answer.value,s,n);this.userAnswerEvent.emit(i)}buildUserAnswer(t,n,s){let i=new Q(-1,t,"TEXT_PLAIN","en","USER_ANSWER",[]);return new Y(this.studyTest.answers,i,"WRITE",n,s,this.studyTest.dbName,this.studyTest.elementIdDb,this.studyTest.learningElementId,this.studyTest.repetitionId,"")}calcDeltaList(t){let n=[];for(let s=0;s<t.length-1;s++){let i=t[s].getTime(),r=t[s+1].getTime();n.push(r-i)}return n}calcThinkingTime(t){let n=0;for(let s of t)s>this.WRITE_DELTA_MS&&(n+=s);return Math.round(n/1e3)}calcTotalTime(t){let n=0;for(let s of t)n+=s;return Math.round(n/1e3)}}function xe(u,t){}U.\u0275fac=function(t){return new(t||U)(e.Y36(l.qu))},U.\u0275cmp=e.Xpm({type:U,selectors:[["study-write-test"]],inputs:{studyTest:"studyTest"},outputs:{userAnswerEvent:"userAnswerEvent"},decls:3,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],["type","text","formControlName","answer",1,"form-control",3,"ngModelChange"],[1,"col-4"],["type","submit",1,"btn","btn-primary"],[1,"text-center"],["class","text-center",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div"),e.YNc(1,ye,10,1,"div",0),e.YNc(2,Ae,10,2,"div",0),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.isShowAnswer),e.xp6(1),e.Q6J("ngIf",n.isShowAnswer))},dependencies:[c.sg,c.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u]});class q{constructor(){this.userAnswerEvent=new e.vpe}ngOnInit(){console.debug("study-test-component init"),this.loadTest()}loadTest(){let t;switch(this.studyTest.type){case"SM2":console.debug("sm2"),t=m;break;case"WRITE":console.debug("write"),t=U;break;default:console.debug("default - sm2"),t=m}let n=this.test.viewContainerRef;n.clear();let s=n.createComponent(t);s.instance.studyTest=this.studyTest,s.instance.userAnswerEvent.subscribe(i=>this.addAnswer(i))}addAnswer(t){console.debug("answer event"),this.userAnswerEvent.emit(t)}}function Se(u,t){if(1&u&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&u){const n=t.$implicit;e.Q6J("ngValue",n),e.xp6(1),e.Oqu(n)}}function Ee(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div")(1,"div",3)(2,"div",4)(3,"label"),e._uU(4,"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u044f\u0437\u044b\u043a"),e.qZA(),e.TgZ(5,"input",5),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.reviewService.targetLang=i)}),e.qZA()(),e.TgZ(6,"div",4)(7,"label"),e._uU(8,"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u044f\u0437\u044b\u043a"),e.qZA(),e.TgZ(9,"input",5),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.reviewService.sourceLang=i)}),e.qZA()()(),e.TgZ(10,"div",6)(11,"div",4)(12,"label"),e._uU(13,"\u0422\u0438\u043f \u0442\u0435\u0441\u0442\u0430"),e.qZA(),e.TgZ(14,"select",7),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.reviewService.type=i)}),e.YNc(15,Se,2,2,"option",8),e.qZA()(),e.TgZ(16,"div",4)(17,"button",9),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.getStudyTests())}),e._uU(18,"\u041d\u0430\u0447\u0430\u0442\u044c"),e.qZA()()()()}if(2&u){const n=e.oxw();e.xp6(5),e.Q6J("ngModel",n.reviewService.targetLang),e.xp6(4),e.Q6J("ngModel",n.reviewService.sourceLang),e.xp6(5),e.Q6J("ngModel",n.reviewService.type),e.xp6(1),e.Q6J("ngForOf",n.testTypes)}}function Ue(u,t){1&u&&(e.TgZ(0,"div",11)(1,"label"),e._uU(2," \u0421\u043b\u0430\u0431\u044b\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b. \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u0443\u044e \u0442\u0435\u043c\u0443. "),e.qZA()())}function qe(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"div",14)(1,"p",15),e._uU(2),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.onFinish())}),e._uU(4," \u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c "),e.qZA()()}if(2&u){const n=e.oxw(2);e.xp6(2),e.AsE("",n.curTestId+1," \u0438\u0437 ",n.reviewService.getTestCount(),"")}}function Fe(u,t){if(1&u){const n=e.EpF();e.TgZ(0,"study-study-test",17),e.NdJ("userAnswerEvent",function(i){e.CHM(n);const r=e.oxw(2);return e.KtG(r.addUserAnswer(i))}),e.qZA()}if(2&u){const n=e.oxw(2);e.Q6J("studyTest",n.curTest)}}function Le(u,t){if(1&u&&(e.TgZ(0,"div"),e.YNc(1,qe,5,2,"div",12),e._UZ(2,"hr"),e.TgZ(3,"div"),e.YNc(4,Fe,1,1,"study-study-test",13),e.qZA()()),2&u){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",!n.isFinish),e.xp6(3),e.Q6J("ngIf",n.isShowChild&&!n.isFinish)}}q.\u0275fac=function(t){return new(t||q)},q.\u0275cmp=e.Xpm({type:q,selectors:[["study-study-test"]],viewQuery:function(t,n){if(1&t&&e.Gf(f,7),2&t){let s;e.iGM(s=e.CRH())&&(n.test=s.first)}},inputs:{studyTest:"studyTest"},outputs:{userAnswerEvent:"userAnswerEvent"},decls:9,vars:1,consts:[[1,"row","justify-content-center"],[1,"col-md-9","col-lg-6"],[1,"text-center",2,"white-space","pre-line"],["studyAnswerTest",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"p"),e._uU(4,"\u0412\u043e\u043f\u0440\u043e\u0441:"),e.qZA(),e.TgZ(5,"h4",2),e._uU(6),e.qZA()(),e._UZ(7,"hr"),e.YNc(8,xe,0,0,"ng-template",3),e.qZA()()),2&t&&(e.xp6(6),e.hij(" ",n.studyTest.question.content," "))},dependencies:[f]});class F{constructor(t,n,s){this.reviewService=t,this.router=n,this.route=s,this.curTestId=0,this.isShowChild=!1,this.isFinish=!1,this.testTypes=["SM2","WRITE"],this.noTests=!1}ngOnInit(){this.reviewService.targetLang&&this.reviewService.sourceLang&&this.reviewService.learningTopicIds&&0==this.reviewService.tests.length?console.debug("onSetup"):!this.reviewService.finished&&this.reviewService.targetLang&&this.reviewService.sourceLang?!this.reviewService.finished&&this.reviewService.tests.length>0&&(this.curTest=this.reviewService.getCurTest(),this.curTestId=this.reviewService.tests.indexOf(this.curTest),this.isShowChild=!0,console.debug("continue review")):(this.reviewService.onReview(),console.debug("onReview"))}getStudyTests(){this.reviewService.getStudyTests().subscribe({next:t=>{this.curTest=this.reviewService.getCurTest(),this.isShowChild=!0},error:t=>{this.noTests=!0,console.error(t)}})}endStudyTests(){this.reviewService.endStudyTests().subscribe({next:t=>{this.isFinish=!0,this.router.navigate(["app/test/results"]),console.debug("Send!")},error:t=>{console.error(t)}})}addUserAnswer(t){console.debug(t),this.reviewService.addAnswer(t),this.isShowChild=!1,this.curTestId+1!=this.reviewService.getTestCount()?(this.curTestId+=1,this.curTest=this.reviewService.getNextTest(),console.debug(this.curTestId),setTimeout(()=>{this.isShowChild=!0},50)):this.endStudyTests()}onFinish(){this.endStudyTests()}}function De(u,t){if(1&u&&(e.TgZ(0,"tr")(1,"th",5),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",6),e._uU(5),e.qZA()(),e.TgZ(6,"td",7),e._uU(7),e.qZA(),e.TgZ(8,"td",7),e._uU(9),e.qZA(),e.TgZ(10,"td",7),e._uU(11),e.qZA()()),2&u){const n=t.$implicit,s=t.index,i=e.oxw();e.xp6(2),e.Oqu(s+1),e.xp6(2),e.MGl("routerLink","../../stats/lelement/",n.learningElement.id,""),e.xp6(1),e.hij(" ",i.getContent(n.card,n.learningElement.element.targetLang)," "),e.xp6(2),e.hij(" ",null==n.learningElement.lastRep||null==n.learningElement.lastRep.answer?null:n.learningElement.lastRep.answer.accuracy," "),e.xp6(2),e.hij(" ",null==n.learningElement.lastRep||null==n.learningElement.lastRep.answer?null:n.learningElement.lastRep.answer.retrievability," "),e.xp6(2),e.hij(" ",i.getLocaleDateString(n.learningElement.nextRep.date)," ")}}F.\u0275fac=function(t){return new(t||F)(e.Y36(h),e.Y36(o.F0),e.Y36(o.gz))},F.\u0275cmp=e.Xpm({type:F,selectors:[["study-study-tests"]],decls:6,vars:3,consts:[[1,"mt-3"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"row","my-2"],[1,"col"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"row","my-2","align-items-end"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[3,"ngValue"],[1,"alert","alert-danger"],["class","justify-content-between row",4,"ngIf"],[3,"studyTest","userAnswerEvent",4,"ngIf"],[1,"justify-content-between","row"],[1,"col-auto"],[1,"btn","btn-success","col-auto","mx-2",3,"click"],[3,"studyTest","userAnswerEvent"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"\u0422\u0435\u0441\u0442\u044b"),e.qZA(),e.YNc(3,Ee,19,4,"div",1),e.YNc(4,Ue,3,0,"div",2),e.YNc(5,Le,5,2,"div",1),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",!n.curTest),e.xp6(1),e.Q6J("ngIf",n.noTests),e.xp6(1),e.Q6J("ngIf",n.curTest))},dependencies:[c.sg,c.O5,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.On,q]});class L{constructor(t,n){this.reviewService=t,this.studyService=n}ngOnInit(){this.reviewService.finished&&this.getResults()}getResults(){let t=[];for(let n of this.reviewService.answers)t.push(n.learningElementId);this.studyService.getStatsByIds(t).subscribe({next:n=>{this.results=n,console.debug(n)},error:n=>{console.error(n)}})}getContent(t,n){for(let s of t.sides)if(s.lang===n)return s.content}getLocaleDateString(t){let n=new Date(t),s=new Date,i=n.getTime()-s.getTime(),r=Math.ceil(i/864e5);return 0==r?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":1==r?"\u0417\u0430\u0432\u0442\u0440\u0430":r<=31&&r>0?`\u0427\u0435\u0440\u0435\u0437 ${r} \u0434\u043d\u0435\u0439`:n.toLocaleDateString()}}L.\u0275fac=function(t){return new(t||L)(e.Y36(h),e.Y36(g))},L.\u0275cmp=e.Xpm({type:L,selectors:[["app-study-tests-results"]],decls:19,vars:1,consts:[[1,"mt-3"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"link","link-primary",3,"routerLink"],[1,"text-nowrap"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b"),e.qZA(),e.TgZ(3,"div",1)(4,"table",2)(5,"thead")(6,"tr")(7,"th",3),e._uU(8,"#"),e.qZA(),e.TgZ(9,"th",3),e._uU(10,"\u0421\u043b\u043e\u0432\u043e"),e.qZA(),e.TgZ(11,"th",3),e._uU(12,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c, %"),e.qZA(),e.TgZ(13,"th",3),e._uU(14,"\u041f\u0430\u043c\u044f\u0442\u044c, %"),e.qZA(),e.TgZ(15,"th",3),e._uU(16,"\u0421\u043b\u0435\u0434. \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0435"),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,De,12,6,"tr",4),e.qZA()()()()),2&t&&(e.xp6(18),e.Q6J("ngForOf",n.results))},dependencies:[c.sg,o.rH]});const Ie=[{path:"",component:x,canActivate:[T],canActivateChild:[T],children:[{path:"",component:A},{path:"courses",component:b},{path:"course/:id",component:y},{path:"test",component:F},{path:"test/results",component:L},{path:"stats/ltopic/:lTopicId",component:E},{path:"stats/lelement/:lElementId",component:S}]}];class v{}v.\u0275fac=function(t){return new(t||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({imports:[o.Bz.forChild(Ie),o.Bz]});class C{}C.\u0275fac=function(t){return new(t||C)},C.\u0275mod=e.oAB({type:C}),C.\u0275inj=e.cJS({imports:[c.ez,v,p.IJ,l.u5,l.UX,N.JF]})}}]);